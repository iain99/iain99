<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Intro | Practical 2 - Understanding correlation and further exploring relationships</title>
  <meta name="description" content="3 Intro | Practical 2 - Understanding correlation and further exploring relationships" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Intro | Practical 2 - Understanding correlation and further exploring relationships" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Intro | Practical 2 - Understanding correlation and further exploring relationships" />
  
  
  

<meta name="author" content="Room 420" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="examples.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Practical 2</a></li>
<li class="chapter" data-level="2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>2</b> Examples</a>
<ul>
<li class="chapter" data-level="2.1" data-path="examples.html"><a href="examples.html#example-1---crime-dataset"><i class="fa fa-check"></i><b>2.1</b> Example 1 - crime dataset</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> Intro</a>
<ul>
<li class="chapter" data-level="3.1" data-path="intro.html"><a href="intro.html#intended-learning-outcomes"><i class="fa fa-check"></i><b>3.1</b> Intended Learning Outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="intro.html"><a href="intro.html#introduction"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="intro.html"><a href="intro.html#population-correlation-hypothesis-test"><i class="fa fa-check"></i><b>3.3</b> Population correlation hypothesis test</a></li>
<li class="chapter" data-level="3.4" data-path="intro.html"><a href="intro.html#calculating-the-correlation-by-hand"><i class="fa fa-check"></i><b>3.4</b> Calculating the correlation by hand</a></li>
<li class="chapter" data-level="3.5" data-path="intro.html"><a href="intro.html#example-1---multiple-linear-regression"><i class="fa fa-check"></i><b>3.5</b> Example 1 - Multiple linear regression</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practical 2 - Understanding correlation and further exploring relationships</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Intro<a href="intro.html#intro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Intended Learning Outcomes<a href="intro.html#intended-learning-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After attending this lab, you should be able to use <code>R</code> to:</p>
<ul>
<li>interpret the population (sample) correlation coefficient;</li>
<li>perform tests on the population correlation;</li>
<li>simulate random variables with different levels of correlation; and</li>
<li>calculate the correlation coefficient using what was learned in lectures.</li>
</ul>
</div>
<div id="introduction" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Introduction<a href="intro.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the lectures we learned how to assess the strength of a linear relationship between random variables using the correlation coefficient. The population correlation is a measure of the magnitude of the strength of the relationship between two random variables X and Y, and is defined as</p>
<p><span class="math display" id="eq:eq1">\[\begin{equation}
\rho(X,Y) = \frac{\text{Cov}(X,Y)}{\sqrt{\text{Var}(X)\text{Var}(Y)}},
\tag{2.1}
\end{equation}\]</span></p>
<p>and can be estimated by replacing each of <span class="math inline">\(\text{Cov}(X,Y)\)</span>, (X) and (Y) by their unbiased estimators to give</p>
<p><span class="math display" id="eq:eq2">\[\begin{equation}
r = \frac{S_{xy}}{\sqrt{S_{xx}S_{yy}}}=\frac{\sum^{n}_{i=1}(x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum^{n}_{i=1}(x_i-\overline{x})^2(y_i-\overline{y})^2}},
\tag{3.1}
\end{equation}\]</span></p>
<p>the <strong>sample correlation coefficient</strong> (-1 <span class="math inline">\(\le\)</span> r <span class="math inline">\(\le\)</span> 1).</p>
<p>Given a sample of data, we can assess the statistical significance of the observed correlations between
variables in the wider population. To do this we perform a hypothesis test.</p>
</div>
<div id="population-correlation-hypothesis-test" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Population correlation hypothesis test<a href="intro.html#population-correlation-hypothesis-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall Example 1 from <strong>Practical 1</strong> in which volunteers had their power output (in watts), weight, and leg
length measurements recorded. Firstly, set the working directory of RStudio to that in which you have
stored your <code>R</code> files and the data by going to:</p>
<center>
<code>Session &gt; Set Working Directory &gt; To Source File Location</code>
</center>
<p>Now open the data from Example 1 by typing the following command from your <code>R</code> script:</p>
<center>
<code>phys &lt;- read.csv("phys1.csv")</code>
</center>
<p>Here we would like to assess the strength of the relationship, if any, between <em>Power Output</em> and <em>Weight</em>,
which we explored in scatterplots in the previous practical, displayed in Figure 1. We are going to do this
for male and female volunteers separately, such that we assess the statistical significance of the observed
correlation between these two variables in the wider populations of (i) males and (ii) females.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig1"></span>
<img src="_main_files/figure-html/fig1-1.png" alt="Scatterplot of Power Output versus Weight." width="672" />
<p class="caption">
Figure 3.1: Scatterplot of Power Output versus Weight.
</p>
</div>
<p>Firstly, we subset the data for males and females. One way to do this is:</p>
<center>
<code>physM &lt;- subset(phys, Gender == "Male", data = phys)</code>
</center>
<center>
<code>physF &lt;- subset(phys, Gender == "Female", data = phys)</code>
</center>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  physF$Power1 and physF$Weight
## t = 1.42, df = 13, p-value = 0.1791
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.1795155  0.7398300
## sample estimates:
##       cor 
## 0.3664454</code></pre>
<p>We now perform, separately for males and females, the following hypothesis test:</p>
<center>
<span class="math inline">\(H_0: \rho=0\)</span> vs. <span class="math inline">\(H_1:\rho \ne 0\)</span>
</center>
<p>We test the null hypothesis, <span class="math inline">\(H_0\)</span>, that is, that in the population of males/females the correlation between
<em>Power Output</em> and <em>Weight</em> is 0 against the alternative hypothesis, <span class="math inline">\(H_1\)</span>, that the correlation is not equal to 0.</p>
<p>To compute the sample correlation coefficient, <code>r</code>, and perform our hypothesis test, we use the <code>cor.test</code>
command. For the males data, the command is as follows:</p>
<center>
<code>cor.test(physM$Power1, physM$Weight)</code>
</center>
<p>Note: in the <code>cor.test</code> command the $ notation is required to access the variables from the subsetted data.</p>
<p>The hypothesis test produces a <em>p</em>-value, where we reject the null hypothesis, <span class="math inline">\(H_0\)</span>, for small values of the
<em>p</em>-value (typically <em>p</em>-values &lt; 0.05). It also produces a 95% confidence interval for a range of plausible
values for the true population correlation.</p>
<p>What is the sample correlation coefficient for the males data? <input class='webex-solveme nospaces' size='6' data-answer='["0.8136"]'/> <em>(to 4 decimal places)</em></p>
<p>What is the <em>p</em>-value for the test? <input class='webex-solveme nospaces' size='8' data-answer='["0.000224"]'/> <em>(to 6 decimal places)</em></p>
<p>The sample correlation coefficient tells us that <em>Power Output</em> and <em>Weight</em> have a <select class='webex-select'><option value='blank'></option><option value=''>weak</option><option value='answer'>strong</option></select>, <select class='webex-select'><option value='blank'></option><option value=''>negative</option><option value='answer'>positive</option></select> relationship.</p>
<p>Based on the p-value of the test, we would <select class='webex-select'><option value='blank'></option><option value='answer'>reject the null hypothesis</option><option value=''>fail to reject the null hypothesis</option></select>.</p>
<p>Perform the same test on the Female data.</p>
<p>What is the sample correlation coefficient for the females data? <input class='webex-solveme nospaces' size='6' data-answer='["0.3664"]'/> <em>(to 4 decimal places)</em></p>
<p>What is the <em>p</em>-value for the test? <input class='webex-solveme nospaces' size='6' data-answer='["0.1791"]'/> <em>(to 4 decimal places)</em></p>
<p>The sample correlation coefficient tells us that <em>Power Output</em> and <em>Weight</em> have a <select class='webex-select'><option value='blank'></option><option value='answer'>weak</option><option value=''>strong</option></select>, <select class='webex-select'><option value='blank'></option><option value=''>negative</option><option value='answer'>positive</option></select> relationship.</p>
<p>Based on the p-value of the test, we would <select class='webex-select'><option value='blank'></option><option value=''>reject the null hypothesis</option><option value='answer'>fail to reject the null hypothesis</option></select>.</p>
<p>Note: if we do not subset the data by gender, we obtain a sample correlation coefficient <span class="math inline">\(r = 0.89\)</span>, with a <em>p</em>-value <span class="math inline">\(\lt\)</span> 0.05, and thus we would conclude that there is a strong, positive linear relationship between Power Output and Weight. However, we now know that is not the case for females.</p>
</div>
<div id="calculating-the-correlation-by-hand" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Calculating the correlation by hand<a href="intro.html#calculating-the-correlation-by-hand" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To compute the sample correlation coefficient, r, the command cor.test uses the formula given in <a href="intro.html#eq:eq2">(3.1)</a>.
To check that the cor.test command is ‘correct’, we can ourselves calculate the correlation directly
using the following commands:</p>
<center>
<code>var # computes the variance of a given vector</code>
</center>
<center>
<code>cov # computes the covariance between the vectors x and y</code>
</center>
<center>
<code>sum # returns the sum of the values given</code>
</center>
<center>
<code>mean # computes the mean of a given vector</code>
</center>
<center>
<code>sqrt # computes the square-root of a given vector</code>
</center>
<ol style="list-style-type: lower-alpha">
<li>Using the commands <code>var</code> and <code>cov</code>, compute the variance and covariance given in <a href="examples.html#eq:eq1">(2.1)</a> for the males
data, where <em>Y</em> denotes the response variable <em>Power Output</em>, and <em>X</em> denotes the explanatory variable
<em>Weight</em>.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="intro.html#cb6-1" aria-hidden="true" tabindex="-1"></a>crime <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;crime.csv&quot;</span>)</span>
<span id="cb6-2"><a href="intro.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="intro.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(crime[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">lower.panel =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div id="section" class="section level4" number="3.4.0.1">
<h4><span class="header-section-number">3.4.0.1</span> </h4>
</div>
</div>
<div id="example-1---multiple-linear-regression" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Example 1 - Multiple linear regression<a href="intro.html#example-1---multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="examples.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
