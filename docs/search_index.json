[["index.html", "S1Z Lab 2 Welcome to S1Z Lab 1", " S1Z Lab 2 Welcome to S1Z Lab 1 In this lab activity, we will learn how to perform an ANOVA using R. The material within this lab has been based on OpenIntro Chapters 7 OpenIntro Page 285. Feel free to refer back to the materials to help you with this lab. As explained in lab 0, all lab work in S1Z are self contained through the use of R consoles. The material within this lab has been based on OpenIntro. All of the artwork used is by @allison_horst. "],["coping-with-surgery.html", "Coping With Surgery Context Research Questions Data", " Coping With Surgery Context Patients undergoing any surgical procedure often show signs of anxiety. A psychologist has conducted a study, in which surgical patients have been randomly allocated to one of four different therapy methods. Each patient has been scored before the therapy begins and after the conclusion of the therapy. Low scores indicate the presence of anxiety and so an increase in score represents an improvement in a patientâ€™s condition. Research Questions Is there evidence that any of the therapy methods is more effective in increasing the average score of patients? In other words, On average, is there any evidence of a difference in the effectiveness of the therapy methods? If so, which therapy methods are likely to differ? And by how much? Data The data contains the following variables: INITIAL : initial score FINAL : final score TREAT : treatment group coded as a number 1 - Control 2 - Behavioural 3 - Drug 4 - Aversion RESPONSE : final score - initial score TYPE : a text version of TREAT, i.e., a short description of the treatment You can download a .csv file of the data from our Moodle page. The filename is surgery.csv. "],["exploring-the-data.html", "Exploring the Data Importing the Data Creating boxplot Producing summary measures", " Exploring the Data In this section, you will explore the data by computing summary statistics and visualizing the data. Importing the Data The data to be analyzed are saved in a dataframe object called surgery which can be imported using the following code. surgery &lt;- read.csv(url(&quot;https://raw.githubusercontent.com/StephenVillejo/S1Z.AnovaLab/main/surgery.csv&quot;)) surgery Exercise 1 Modify the code above to limit the number of rows of surgery printed to only 5. Hint The function head() will give a limited view of a dataset. Solution head(surgery) ## INITIAL FINAL TREAT RESPONSE TYPE ## 1 30.2 32.0 1 1.8 control ## 2 35.3 34.8 1 -0.5 control ## 3 32.4 34.6 1 2.2 control ## 4 31.9 34.2 1 2.3 control ## 5 28.4 30.3 1 1.9 control ## 6 30.5 33.2 1 2.7 control Creating boxplot The basic code below produces a boxplot of the variable RESPONSE by TYPE. Specified in the ggplot() function is the (1) data argument which is the data frame to use for plot, and the (2) mapping argument which describes how the variables in the data are mapped to the visual properties (aesthetics) of the plot that you want. In the mapping argument, we specify in the x argument our grouping variable which is TYPE and in the y argument the variable whose values we plot which is RESPONSE in our data. Finally, we use the geom_boxplot() function to produce the boxplot. Run this code in your own R console to view the boxplot. ggplot(data = surgery, mapping = aes(x=TYPE, y=RESPONSE)) + geom_boxplot() Exercise 2 Using the labs() function, modify the code above to put a title in the plot. In the labs() function, the argument for the title is called title. Hint You want to include in the code labs(title = \"Boxplot of the response variable by type of treatment\"). Solution ggplot(data = surgery, mapping = aes(x=TYPE, y=RESPONSE)) + geom_boxplot() + labs(title = &quot;Boxplot of the response variable by type of treatment&quot;) Which group appears to have the highest increase in the score on the average? aversion drug behav control Hint Compare the lines inside the boxes and see which among the four is the largest. Recall that the line inside the box of a boxplot corresponds to the median. Which of the following can be said on the increase in the score for the aversion group? The scores of the aversion group are badly skewed with some outliers. Some of the patients in the aversion group have lower final score compared to the initial anxiety score. The median score is closer to the 3rd quartile than the 2nd quartile. The median difference between the final and initial score is close to zero. Hint Recall how to interpret the boxplot. The line that divides the box into two parts is the median, while the two lines that form the box are the 1st and 3rd quartiles. When the median is very close to either the bottom or top of the box, and if a whisker is more extended while the other whisker is shorter, then the distribution is skewed. Finally, a data point that is located outside the whiskers of the box plot is an outlier.\" Producing summary measures The code below produces the mean of the variable RESPONSE by TYPE. The code uses pipes, denoted by %&gt;%, which is a powerful tool for expressing a sequence of multiple operations. The code starts with specifying the dataframe surgery. Next, it uses the group_by() function so that the succeeding operations are performed by group. We specify inside the group_by() function the grouping variable which is TYPE. Finally, we use the summarise() function to compute summary statistics. In the code below, we use the function mean() to compute the mean. The summarise() function produces a new data frame with the number of rows as the number of groups and the number of columns as the number of summary measures computed. You may specify more than one function, separated by ,, inside the summarise() function if you wish to compute other summary measures in addition to the mean. Run this code in your own R console to view the summary. surgery %&gt;% group_by(TYPE) %&gt;% summarise(mean = mean(RESPONSE)) Exercise 3 Modify the code above to produce both the mean and the standard deviation for each treatment group. Hint Within the summarise() function, you want to calculate the standard deviation as well as the mean, using sd(). Solution surgery %&gt;% group_by(TYPE) %&gt;% summarise(mean = mean(RESPONSE) , sd = sd(RESPONSE)) ## # A tibble: 4 x 3 ## TYPE mean sd ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 aversion 0.44 1.35 ## 2 behav 1.5 0.688 ## 3 control 1.45 0.981 ## 4 drug 5.79 0.933 Which of the following is/are true? The variability in the response variable is highest in the group of patients who underwent the aversion therapy. The patients in the control group experienced the least mean improvement in anxiety levels among the four treatment groups. The patients who underwent the drug therapy experienced the highest mean decline in the anxiety level. Hint Recall how to interpet basic summary statistics such as mean, median, standard deviation, and skewness. "],["anova.html", "ANOVA Hypotheses ANOVA table", " ANOVA We now perform a one-way analysis of variance. We wish to test whether the mean increase in the anxiety score is the same under the four treatment groups. Hypotheses Let \\(\\mu_{a}\\) = mean increase in anxiety score for the aversion group \\(\\mu_{b}\\) = mean increase in anxiety score for the behavioural group \\(\\mu_{c}\\) = mean increase in anxiety score for the control group \\(\\mu_{d}\\) = mean increase in anxiety score for the drug group What is the form of the null hypothesis for ANOVA? \\(\\mu_{a} = \\mu_{b} = \\mu_{c} = \\mu_{d}\\) \\(\\mu_{a} = \\mu_{b} = \\mu_{c} = \\mu_{d} = 0\\) \\(\\mu_{a} + \\mu_{b} = \\mu_{c} + \\mu_{d}\\) \\(\\mu_{a} + \\mu_{b} + \\mu_{c} + \\mu_{d}= 0\\) Hint The null hypothesis of ANOVA is that all populations means are equal. What is the form of the alternative hypothesis for ANOVA? \\(\\mu_{a} - \\mu_{b} - \\mu_{c} - \\mu_{d} \\neq 0\\) \\(\\mu_{a} \\neq \\mu_{b} \\; or \\; \\mu_{a} \\neq \\mu_{c} \\; or \\; \\mu_{a} \\neq \\mu_{d} \\; or \\; \\mu_{b} \\neq \\mu_{c} \\; or \\; \\mu_{b} \\neq \\mu_{d} \\; or \\; \\mu_{c} \\neq \\mu_{d}\\) \\(\\mu_{a} \\neq \\mu_{b} \\neq \\mu_{c} \\neq \\mu_{d} \\neq 0\\) \\(\\mu_{a} \\neq \\mu_{b} \\neq \\mu_{c} \\neq \\mu_{d}\\) Hint The alternative hypothesis of ANOVA is that not all means are equal to each other. An equivalent statement is that at least one pair of means are not equal to each other. ANOVA table Exercise 4 We use the function aov() to perform the Analysis of Variance and to produce the ANOVA table. The important arguments to run the aov() function are the following: (1) formula which is the formula specifying the model, and (2) data which is a data frame where the variables specified in the formula will be found. The formula argument takes the form Y~X where Y is the response variable and X is the grouping or factor variable. Perform the ANOVA test. Store the results in an object called anova.results. Use the summary() function to check the results of ANOVA. An important argument of the summary() function is object which is the object for which a summary is desired. Hint The arguments given to aov() should be formula = RESPONSE ~ TYPE and data = surgery. Solution anova.results &lt;- aov(formula = RESPONSE ~ TYPE, data = surgery) summary(object = anova.results) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## TYPE 3 170.02 56.67 54.73 1.72e-13 *** ## Residuals 36 37.28 1.04 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 What is the value of SST? Hint Recall that SST = SSE + SSG. What is the degrees of freedom for the SST? Hint Recall that \\(df_E = df_T - df_G.\\) What is the distribution of the F-statistic (under Ho)? \\(F \\; \\text{with numerator df = 36 and denominator df = 3}\\) \\(F \\; \\text{with numerator df = 39 and denominator df = 36}\\) \\(F \\; \\text{with numerator df = 3 and denominator df = 36}\\) \\(F \\; \\text{with numerator df = 36 and denominator df = 39}\\) Hint Recall that that numerator degrees of freedom is \\(df_G\\), while the denominator degrees of freedom is \\(df_E\\). Using a significance level of 0.05, what is your conclusion based on the p-value of the F-test? Since the p-value is less than 0.05, we reject Ho and conclude that not all means are equal. Since the p-value is less than 0.05, we reject Ho and conclude that all the means are not equal to each other. Since the p-value is less than 0.05, we do not reject Ho and conclude that we don't have enough evidence to conclude that not all means are equal. Since the p-value is less than 0.05, we do not reject Ho and conclude that we don't have enough evidence to conclude that all means are equal. Hint Recall that we reject Ho if the p-value is less than the significance level. If Ho is rejected, then we conclude that at least one mean is different or that not all means are equal. "],["multiple-comparisons.html", "Multiple Comparisons", " Multiple Comparisons Having established that the population means are not all equal, we wish to establish where the significant differences are likely to lie. We do this by performing multiple comparisons using the Bonferroni correction. What is the value of the adjusted \\(\\alpha^*\\)? Hint Recall that \\(\\alpha^*=\\frac{\\alpha}{K}\\), where \\(K\\) is the number of comparisons to be made. We have \\(K = \\frac{4\\times 3}{2}=6\\). To perform multiple comparisons, we use the function pairwise.t.test() in the stats package. The basic arguments of the pairwise.t.test() function for our purpose are: (1) x for the response vector, (2) g for the grouping vector or factor, (3) pool.sd which allows/disallows the use of a pooled standard deviation, and (4) p.adj which is the type of adjustment on the p-values from the pairwise t-test. For more information about the function, you can run the line ?pairwise.t.test below. Recall that one of the assumptions of ANOVA is equal variability across groups. This is the reason why we use the data from all groups to estimate variability. We used \\(\\sqrt{MSE}\\) as our estimate for the pooled standard deviation. To implement this, we specify pool.sd = TRUE. Moreover, for our purpose, we specify p.adj = \"none\". Exercise 5 Using the the function pairwise.t.test(), perform multiple comparisons test. Hint The response vector we're using is surgery$RESPONSE and the grouping vector is surgery$TYPE. Solution pairwise.t.test(x = surgery$RESPONSE, g = surgery$TYPE, pool.sd = TRUE, p.adj = &#39;none&#39;) ## ## Pairwise comparisons using t tests with pooled SD ## ## data: surgery$RESPONSE and surgery$TYPE ## ## aversion behav control ## behav 0.026 - - ## control 0.033 0.913 - ## drug 7.0e-14 2.9e-11 2.2e-11 ## ## P value adjustment method: none The output from the above code shows the p-values of the pairwise t-tests using \\(\\sqrt(MSE)\\) as the estimate for \\(s_p\\). We have computed the adjusted \\(\\alpha\\) which is 0.0083. Now we identify which pairs have significantly different means. Which of the following can you conclude based on the multiple comparisons? \\(\\mu_{a} \\neq \\mu_{b}\\) \\(\\mu_{a} \\neq \\mu_{d}\\) \\(\\mu_{a} \\neq \\mu_{c}\\) \\(\\mu_{b} \\neq \\mu_{d}\\) \\(\\mu_{b} \\neq \\mu_{c}\\) \\(\\mu_{c} \\neq \\mu_{d}\\) Hint Recall that a pair of means are significantly different if the p-value is less than than adjusted \\(\\alpha\\). The result from the multiple comparisons appear to agree with our boxplot in the data visualization/exploration stage: "],["graphical-diagnostics.html", "Graphical Diagnostics Independence assumption Normality assumption Constant variance across groups", " Graphical Diagnostics Recall that in our ANOVA model we have the following assumptions: The observations are independent within and between groups. The observations within each group are nearly normal. The variability across the groups are equal. Independence assumption Recall that if the data are a simple random sample, this condition is satisfied. For our experimental data, there are not obvious reasons why independence would not hold for most or all observations. Normality assumption The normality assumption is especially important when the sample size is quite small. However, for the case of small sample sizes, it is difficult to check for non-normality. The code below produces the histogram for the response scores for the control group using the ggplot() function. The first argument is the data frame containing the scores. The expression which(surgery$TYPE==\"control\") identifies the rows for which the value for TYPE is control. Furthermore, surgery[which(surgery$TYPE==\"control\"),] means that we are only getting the rows from the full data for which the value for TYPE is control. This is one of the several ways to subset dataframes in R. In the next argument of the ggplot() function, which is mapping, we specify the name of the variable of interest which is RESPONSE. The function geom_histogram generates the histgoram. Some arguments shown below is the colour which refers to the color of the borders of the bars, and the binwidth which specifies the width of the bins. The default value of the binwidth is not very useful since we have a small sample size, which is 10. For the purpose of getting a better look at the distribution of the values, we adjust the value of the binwidth. ggplot(data = surgery[which(surgery$TYPE == &quot;control&quot;),], mapping = aes(x = RESPONSE)) + geom_histogram(fill = &quot;lightblue&quot;, colour = &quot;black&quot;, binwidth = 0.3) + labs(title = &quot;Histogram of the response variable for the control group&quot;) Exercise 6 Modify the code above to produce the histogram for the response scores for the behavioural group. Hint What needs to change from the code above is the type of treatment received; now we are interested in behav rather than control. Don't forget to change the plot title! Solution ggplot(data = surgery[which(surgery$TYPE == &quot;behav&quot;),], mapping = aes(x = RESPONSE)) + geom_histogram(fill = &quot;lightblue&quot;, colour = &quot;black&quot;, binwidth = 0.4) + labs(title = &quot;Histogram of the response variable for the behavioural group&quot;) Exercise 7 Modify the code above to produce the histogram for the response scores for the aversion group. Hint Again, we are only changing the treatment type within the which() function. Solution ggplot(data = surgery[which(surgery$TYPE == &quot;aversion&quot;),], mapping = aes(x = RESPONSE)) + geom_histogram(fill = &quot;lightblue&quot;, colour = &quot;black&quot;, binwidth = 0.4) + labs(title = &quot;Histogram of the response variable for the aversion group&quot;) Exercise 8 Modify the code above to produce the histogram for the response scores for the drugs group: Hint The which() function should be which(surgery$TYPE == \"drug\"). Solution ggplot(data = surgery[which(surgery$TYPE == &quot;drug&quot;),], mapping = aes(x = RESPONSE)) + geom_histogram(fill = &quot;lightblue&quot;, colour = &quot;black&quot;, binwidth = 0.4) + labs(title = &quot;Histogram of the response variable for the drug group&quot;) The sample size is very small so it is difficult to check for non-normality using the histograms above. Constant variance across groups Our graphical approach to check for constant variance across groups is the side-by-side box plot. We already produced the boxplot using the ggplot() and the geom_boxplot() function in the data exploration stage. In addition, we also computed the mean and standard deviation of RESPONSE for each treatment group. The outputs are shown below: ## # A tibble: 4 x 3 ## TYPE mean sd ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 aversion 0.44 1.35 ## 2 behav 1.5 0.688 ## 3 control 1.45 0.981 ## 4 drug 5.79 0.933 The boxplots and summary statistics above show that the aversion group has relatively higher variability compared to the other groups. A formal hypothesis test needs to be performed to check this assumption. If indeed we have evidence of non-constant variance, then other methods should be used for our statistical inquiry on the experimental data. These alternative methods are not within the scope of this course. "],["group-tasks.html", "Group Tasks Context Research Questions Data Loading the Data Task 1 Task 2 Task 3 Task 4", " Group Tasks Context One of the first stages in preparing a patient for surgery is to administer a premedication. This is a mild sedative which is intended to relax the patient both psychologically and physically before he or she is given an appropriate anaesthetic and subsequently undergoes surgery. In an investigation of the effectiveness of three different premedications, a number of patients had their pulse rates recorded before and after one of the three premedications was administered. The effectiveness of a premedication on a particular patient can be quantified by the drop in recorded pulse rate. Research Questions The research questions are as follows: Is there any evidence of a difference in the abilities of the three premedications to lower pulse rate? If so, which premedications differ and by how much? Data The data contains the following variables: Age : initial memory score before treatment Drug : premedication codes (1-3) DrugT: premedication codes (1-3) Pulse_before: pulse rate before the premedication was administered Pulse_after: pulse rate after the premedication was administered Response : the difference between pulse rate before and pulse rate after premedication (before-after) Loading the Data You may download the dataset named premedications.csv file from our Moodle course page. Save the file in your local computer and then use the read.csv() function to import the data in your R. You can load the data set into your workspace by running the code below in an Rscript file in your local Rstudio. Make sure that the premedications.csv file is saved in the same folder as the Rscript file. premed.data &lt;- read.csv(&#39;premedications.csv&#39;) In addition, you need to load the following packages as well: ggplot2 and tidyverse. To load the packages, you simply need to run the following: library(ggplot2) library(tidyverse) Task 1 Create boxplots of the response by each premedication and find the mean and standard deviation of the response in each premedication group. What are the null and alternative hypotheses? \\(H_0:\\mu_{\\text{drug 1}}=\\mu_{\\text{drug 2}}=\\mu_{\\text{drug 3}}\\) and \\(H_A:\\mu_{\\text{drug 1}}\\neq\\mu_{\\text{drug 2}}\\text{ and }\\mu_{\\text{drug 1}}\\neq\\mu_{\\text{drug 3}}\\text{ and }\\mu_{\\text{drug 2}}\\neq\\mu_{\\text{drug 2}}\\) \\(H_0:\\mu_{\\text{drug 1}}=\\mu_{\\text{drug 2}}=\\mu_{\\text{drug 3}}\\) and \\(H_A:\\mu_{\\text{drug 1}}\\neq\\mu_{\\text{drug 2}}\\neq\\mu_{\\text{drug 3}}\\) \\(H_0:\\mu_{\\text{drug 1}}=\\mu_{\\text{drug 2}}=\\mu_{\\text{drug 3}}\\) and \\(H_A:\\mu_{\\text{drug 1}}\\neq\\mu_{\\text{drug 2}}\\text{ or }\\mu_{\\text{drug 1}}\\neq\\mu_{\\text{drug 3}}\\text{ or }\\mu_{\\text{drug 2}}\\neq\\mu_{\\text{drug 2}}\\) \\(H_0:\\mu_{\\text{drug 1}}=\\mu_{\\text{drug 2}}\\text{ or }\\mu_{\\text{drug 1}}=\\mu_{\\text{drug 3}}\\text{ or }\\mu_{\\text{drug 2}}=\\mu_{\\text{drug 2}}\\) and \\(H_A:\\mu_{\\text{drug 1}}\\neq\\mu_{\\text{drug 2}}\\neq\\mu_{\\text{drug 3}}\\) Task 2 Perform the ANOVA using the aov() function. What is the value of SST? Based on the p-value of the F-test, what is your conclusion? Since the p-value is less than 0.05, we reject Ho and conclude that not all means are equal. Since the p-value is less than 0.05, we do not reject Ho and conclude that we don't have enough evidence to conclude that not all means are equal. Since the p-value is less than 0.05, we reject Ho and conclude that none of the means are equal to each other. Since the p-value is less than 0.05, we do not reject Ho and conclude that we don't have enough evidence to conclude that all means are equal.\" Task 3 Perform multiple comparisons using the Bonferroni correction. Use the function pairwise.t.test(). What is the value of \\(\\alpha^*\\) (to 4 decimal places) Which pairs of means are significantly different? No pairs \\(\\mu_\\text{drug 1}\\) and \\(\\mu_\\text{drug 2}\\) \\(\\mu_\\text{drug 1}\\) and \\(\\mu_\\text{drug 3}\\) \\(\\mu_\\text{drug 2}\\) and \\(\\mu_\\text{drug 3}\\) Task 4 Based on the boxplots created in Task 1, is the assumption of equal variance between groups valid? Yes No Create histograms for each of the 3 premedication groups to check the normality assumption. Based on these histograms, is the normality assumption valid? Yes No "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
